<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>웹사이트</title>

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap"
      rel="stylesheet" />

    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="header">
      <div class="header-container active">
        <nav class="nav nav-left">
          <ul class="nav-menu">
            <li><a href="door.html">입구</a></li>
            <li><a href="about_main.html">사후기록</a></li>
          </ul>
        </nav>
        <div class="logo">
          <a href="#"><img src="image/header_Logo.png" alt="Logo" /></a>
        </div>
        <nav class="nav nav-right">
          <ul class="nav-menu">
            <li><a href="dead-assembly.html">망자집회</a></li>
            <li><a href="video.html">차안과 피안</a></li>
          </ul>
        </nav>
        <button class="menu-toggle" aria-label="메뉴 열기">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </header>
    <div class="background-container">
      <div class="top-section">
        <!-- Hero Section -->
        <section id="home" class="hero">
          <div class="hero-inner">
            <div class="hero-stage">
              <div class="hero-core" aria-label="사십구재 중앙 텍스트">
                <div class="hero-subtitle hero-subtitle-top">
                  불교에서 말하는 49일
                </div>
                <div class="hero-subtitle hero-subtitle-middle">사십구재</div>
                <div class="hero-hanja-text" aria-label="사십구재 한자 타이포">
                  <span>四</span>
                  <span>十</span>
                  <span>九</span>
                  <span>齋</span>
                </div>

                <!-- Circles anchored to hero-core center/bottom -->
                <div class="core-orbits" aria-hidden="false">
                  <a
                    href="six-realms.html"
                    class="circle-item left circle-link">
                    <div class="circle-text">
                      <div class="hanja">六道輪廻</div>
                      <div class="label">육도윤회</div>
                    </div>
                  </a>
                  <a
                    href="hell-realm.html"
                    class="circle-item right circle-link">
                    <div class="circle-text">
                      <div class="hanja">地獄道</div>
                      <div class="label">지옥도</div>
                    </div>
                  </a>
                  <a
                    href="intermediate-world.html"
                    class="circle-item bottom circle-link">
                    <div class="circle-text">
                      <div class="hanja">中陰世界</div>
                      <div class="label">중음세계</div>
                    </div>
                  </a>
                </div>

                <!-- 하단 설명 텍스트 -->
                <div class="hero-description-wrapper">
                  <!-- 중앙 텍스트 블록 -->
                  <div class="hero-description">
                    <div class="description-block">
                      <div class="text-line">
                        사람이 죽은 뒤, 망자의 혼은 곧바로 다음 세계로 나아가지
                        않는다. 죽음 이후 49일 동안, 매 7일마다 한 번씩 총 일곱
                        번의 심판을 받으며 생전에 쌓아온 말과 행동, 마음에 남긴
                        업의 무게를 평가받는다.
                      </div>
                      <div class="text-line">
                        이 49일은 저승에서 머무는 마지막 여정이며 망자가
                        스스로를 마주하는 가장 깊은 시간이다. 선과 악의 흔적들은
                        빛과 그림자처럼 드러나고, 그 기록은 저승의 판관들 앞에서
                        한 치의 왜곡 없이 펼쳐진다.
                      </div>
                      <div class="text-line">
                        이 모든 심판이 끝난 후에야 망자의 다음 생, 혹은 그
                        너머의 행방이 결정된다.
                      </div>
                    </div>
                  </div>

                  <!-- 화살표 버튼 -->
                  <button
                    class="scroll-arrow"
                    id="scroll-to-about"
                    aria-label="다음 섹션으로 이동">
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M12 5V19M12 19L19 12M12 19L5 12"
                        stroke="rgba(232, 232, 232, 0.8)"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round" />
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- 곡선 래퍼 - 검은색과 흰색 경계 -->
      <div class="curve-wrapper">
        <svg
          class="top-section-curve"
          viewBox="0 0 100 400"
          preserveAspectRatio="none">
          <!-- 곡선 부분 - 검은색 -->
          <path d="M0,0 L0,150 Q50,400 100,150 L100,0 Z" fill="#000000" />
        </svg>
      </div>

      <div class="bottom-section">
        <!-- About Section -->
        <section id="about" class="about section">
          <!-- 제목과 설명 텍스트 - 두 그룹으로 분리 -->
          <div class="about-title-section">
            <!-- 그룹 1: 오른쪽 정렬 -->
            <div class="group-right">
              <h2>
                <span class="red-box animate-char">불</span
                ><span class="red-box animate-char">교</span
                ><span class="red-box animate-char">에</span
                ><span class="red-box animate-char">서</span
                ><span class="red-box animate-char">말</span
                ><span class="red-box animate-char">하</span
                ><span class="red-box animate-char">는</span><br />
                <span class="red-box animate-char">사</span
                ><span class="red-box animate-char">십</span
                ><span class="red-box animate-char">구</span
                ><span class="red-box animate-char">재</span>
              </h2>
              <p class="fade-text">
                <span class="red-text">불교에서 말하는 사십구재(四十九齋)</span
                >는 사람이 죽은 뒤<br />
                49일 동안 7일마다 한 번씩 총 7번의 심판을 받으며, <br />
                그 결과에 따라 다음 생의 행방이 결정되는 장례의식이다.
              </p>

              <p class="fade-text">
                49일 동안 망자가 중음세계에 머물며 시왕의 심판을<br />
                받는다고 하며, 업의 무게와 성질에 따라 육도윤회 중 한 곳으로<br />
                환생하게 된다고 전한다.
              </p>
            </div>

            <!-- 그룹 2: 왼쪽 정렬 -->
            <div class="group-left">
              <h3>
                <span class="red-box animate-char">디</span
                ><span class="red-box animate-char">사</span
                ><span class="red-box animate-char">구</span
                ><span class="red-box animate-char">저</span
                ><span class="red-box animate-char">승</span
                ><span class="red-box animate-char">국</span><br />
                <span class="red-box animate-char">업</span
                ><span class="red-box animate-char">의</span
                ><span class="red-box animate-char">심</span
                ><span class="red-box animate-char">판</span>
              </h3>
              <p class="fade-text">
                <span class="red-text"
                  >죽음 이후, 우리는 어디로 가게 될까요?</span
                >
              </p>
              <p class="fade-text">
                디사구 저승국은 현실에서의 행동뿐 아니라, 디지털<br />
                공간에서 남긴 댓글, 공유, 이미지, 좋아요, 심지어<br />
                무심코 지나친 방관까지도 '디지털 업(業)'으로 기록됩니다.
              </p>
              <p class="fade-text">
                D-49 저승국에서는 타인을 심판하는 순간, 우리는<br />
                스스로를 심판하는 자리에 서게 됩니다. '디지털에서의<br />
                나도 나인가?'라는 질문을 품고, 당신의 다음 생은<br />
                어디로 향할지 직접 확인해보십시오.
              </p>

              <!-- 임시 이미지 박스 -->
              <div class="temp-image-box slide-up-fade">
                <img src="image/bottle.svg" alt="사십구재" />
              </div>
            </div>
          </div>
        </section>

        <!-- 49재 의미 설명 섹션 -->
        <section id="ritual49" class="ritual-49-section">
          <div class="ritual-49-container">
            <!-- 四 -->
            <div class="ritual-column" data-column="1">
              <div class="ritual-hanja">四</div>
              <div class="ritual-description">
                <p>
                  숫자 4를 뜻하며 깨달음과 생명의 순환, 삶과 죽음의 조화를
                  상징합니다.
                </p>
                <p>
                  네 가지 진리와 연결되어 인간 존재와 윤회의 의미를 담고
                  있습니다.
                </p>
              </div>
            </div>

            <!-- 十 -->
            <div class="ritual-column" data-column="2">
              <div class="ritual-hanja">十</div>
              <div class="ritual-description">
                <p>숫자 10으로 완전함과 단위를 나타냅니다.</p>
                <p>
                  사(4)와 결합해 40이라는 기간적 의미를 만들며, 수행과 기도의
                  기간을 상징하기도 합니다.
                </p>
              </div>
            </div>

            <!-- 九 -->
            <div class="ritual-column" data-column="3">
              <div class="ritual-hanja">九</div>
              <div class="ritual-description">
                <p>
                  숫자 9를 더해 49를 완성합니다. 죽음 이후 영혼이 머무는 49일을
                  뜻하며,
                </p>
                <p>업과 마음을 돌아보는 성찰의 시간을 나타냅니다.</p>
              </div>
            </div>

            <!-- 齋 -->
            <div class="ritual-column" data-column="4">
              <div class="ritual-hanja">齋</div>
              <div class="ritual-description">
                <p>
                  제사와 공양, 정화를 의미합니다. 망자를 위해 정성껏 의식을
                  올리고
                </p>
                <p>
                  마음을 정화하며 업을 되돌아보는 수행의 의미를 담고 있습니다.
                </p>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- 디지털 푸터 섹션 - background-container 안에 배치 -->
      <section class="digital-footer-section">
        <div class="footer-inner">
          <div class="footer-header">
            <h2>Digital Afterlife Records</h2>
            <div class="view-toggle">
              <button class="grid-btn">Grid</button>
              <button class="list-btn active">List</button>
            </div>
          </div>
          <ul class="footer-list">
            <li>
              <span class="footer-title">Department of Judgment</span>
              <span class="footer-role"
                >AI Ethical System / Data Processing</span
              >
              <span class="footer-link">View Records →</span>
            </li>
            <li>
              <span class="footer-title">Office of Karma Transmission</span>
              <span class="footer-role">Digital Traces Management</span>
              <span class="footer-link">Access Portal →</span>
            </li>
            <li>
              <span class="footer-title">Seven Judges Division</span>
              <span class="footer-role"
                >Behavioral Analytics / Memory Archive</span
              >
              <span class="footer-link">Open Files →</span>
            </li>
          </ul>
          <div class="footer-credit">
            <p>© 2025 DISAGU Digital Afterlife Corp. All Rights Reserved.</p>
          </div>
        </div>
      </section>
    </div>

    <script>
      // 헤더는 항상 활성화 상태이므로 로고 클릭으로 토글하는 코드 제거

      // 햄버거 메뉴 토글 (모바일용)
      const menuToggle = document.querySelector(".menu-toggle");
      const navLeft = document.querySelector(".nav-left");
      const navRight = document.querySelector(".nav-right");

      menuToggle.addEventListener("click", () => {
        navLeft.classList.toggle("active");
        navRight.classList.toggle("active");
      });

      // 메뉴 링크 클릭 시 모바일 메뉴 닫기
      const navLinks = document.querySelectorAll(".nav-menu a");
      navLinks.forEach((link) => {
        link.addEventListener("click", () => {
          if (window.innerWidth <= 768) {
            navLeft.classList.remove("active");
            navRight.classList.remove("active");
          }
        });
      });

      // 스크롤 방향에 따라 로고 표시/숨김
      let lastScrollY = window.scrollY;
      const scrollThreshold = 100;

      window.addEventListener("scroll", () => {
        const currentY = window.scrollY;

        if (currentY > scrollThreshold && currentY > lastScrollY) {
          document.body.classList.add("logo-hidden");
        } else if (currentY < lastScrollY || currentY <= scrollThreshold) {
          document.body.classList.remove("logo-hidden");
        }

        lastScrollY = currentY;
      });

      // Hero 섹션 스크롤 애니메이션
      document.addEventListener("DOMContentLoaded", function () {
        const observerOptions = {
          root: null,
          rootMargin: "200px 200px 200px 200px",
          threshold: 0.01,
        };

        const animateElements = (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add("fade-in");
            }
          });
        };

        const observer = new IntersectionObserver(
          animateElements,
          observerOptions
        );

        // Circle 요소들 애니메이션
        const circleItems = document.querySelectorAll(".circle-item");
        const descriptionLines = document.querySelectorAll(
          ".hero-description .text-line"
        );

        const heroSection = document.querySelector(".hero");
        if (heroSection) {
          const checkHeroVisible = () => {
            const rect = heroSection.getBoundingClientRect();
            const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
            if (isVisible) {
              circleItems.forEach((item, index) => {
                setTimeout(() => {
                  item.classList.add("fade-in");
                }, index * 200);
              });
              // 텍스트 라인들 순차 등장
              descriptionLines.forEach((line, index) => {
                if (line.textContent.trim() !== "") {
                  setTimeout(() => {
                    line.style.opacity = "1";
                    line.style.transform = "translateY(0)";
                  }, index * 100);
                }
              });
              return true;
            }
            return false;
          };

          if (!checkHeroVisible()) {
            const heroObserver = new IntersectionObserver(
              (entries) => {
                entries.forEach((entry) => {
                  if (entry.isIntersecting) {
                    circleItems.forEach((item, index) => {
                      setTimeout(() => {
                        item.classList.add("fade-in");
                      }, index * 200);
                    });
                    // 텍스트 라인들 순차 등장
                    descriptionLines.forEach((line, index) => {
                      if (line.textContent.trim() !== "") {
                        setTimeout(() => {
                          line.style.opacity = "1";
                          line.style.transform = "translateY(0)";
                        }, index * 100);
                      }
                    });
                    heroObserver.unobserve(entry.target);
                  }
                });
              },
              {
                root: null,
                rootMargin: "0px",
                threshold: 0.1,
              }
            );
            heroObserver.observe(heroSection);
          }
        } else {
          circleItems.forEach((item) => observer.observe(item));
        }

        // 레드 박스와 텍스트 순차 등장 애니메이션
        const aboutSection = document.querySelector(".about");
        if (aboutSection) {
          const aboutObserver = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  const section = entry.target;

                  // 각 그룹별로 애니메이션 실행
                  const groups = section.querySelectorAll(
                    ".group-right, .group-left"
                  );

                  // 레드박스가 모두 등장하는 시간 계산
                  let maxRedBoxTime = 0;
                  groups.forEach((group, groupIndex) => {
                    const redBoxes = group.querySelectorAll(
                      ".red-box, .animate-char"
                    );
                    const groupStartTime = groupIndex * 500;
                    const groupEndTime = groupStartTime + redBoxes.length * 100;
                    maxRedBoxTime = Math.max(maxRedBoxTime, groupEndTime);
                  });

                  // SVG 이미지 슬라이드 인 애니메이션 (레드박스가 모두 나온 후)
                  const svgImage = document.querySelector(
                    ".temp-image-box img"
                  );
                  if (svgImage) {
                    setTimeout(() => {
                      svgImage.classList.add("slide-in");
                    }, maxRedBoxTime + 200); // 레드박스가 모두 나온 후 200ms 딜레이
                  }

                  groups.forEach((group, groupIndex) => {
                    setTimeout(() => {
                      // 레드 박스들 순차 등장
                      const redBoxes = group.querySelectorAll(
                        ".red-box, .animate-char"
                      );
                      redBoxes.forEach((box, index) => {
                        setTimeout(() => {
                          box.classList.add("fade-in");
                        }, index * 100); // 각 박스마다 100ms씩 딜레이
                      });

                      // 설명 텍스트들 순차 등장 (레드 박스 애니메이션 후)
                      setTimeout(() => {
                        const fadeTexts = group.querySelectorAll(".fade-text");
                        fadeTexts.forEach((text, index) => {
                          setTimeout(() => {
                            text.classList.add("fade-in");
                          }, index * 200); // 각 텍스트마다 200ms씩 딜레이
                        });
                      }, redBoxes.length * 100 + 300); // 레드 박스 애니메이션 완료 후 시작
                    }, groupIndex * 500); // 각 그룹마다 500ms씩 딜레이
                  });

                  aboutObserver.unobserve(entry.target);
                }
              });
            },
            {
              root: null,
              rootMargin: "100px 0px",
              threshold: 0.2,
            }
          );

          aboutObserver.observe(aboutSection);
        }
      });

      // 49재 섹션 스크롤 애니메이션
      const ritualColumns = document.querySelectorAll(".ritual-column");
      if (ritualColumns.length) {
        const ritualObserver = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry, index) => {
              if (entry.isIntersecting) {
                setTimeout(() => {
                  entry.target.classList.add("fade-in");
                }, index * 150);
                ritualObserver.unobserve(entry.target);
              }
            });
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0.2,
          }
        );

        ritualColumns.forEach((column) => {
          ritualObserver.observe(column);
        });
      }

      // 푸터 스크롤 애니메이션
      const footerInner = document.querySelector(
        ".digital-footer-section .footer-inner"
      );
      if (footerInner) {
        const footerObserver = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add("visible");
                footerObserver.unobserve(entry.target);
              }
            });
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0.1,
          }
        );

        footerObserver.observe(footerInner);
      }

      // Grid/List 뷰 전환
      const footerSection = document.querySelector(".digital-footer-section");
      const gridBtn = document.querySelector(".grid-btn");
      const listBtn = document.querySelector(".list-btn");

      if (footerSection && gridBtn && listBtn) {
        // 기본값은 list-view
        footerSection.classList.add("list-view");

        gridBtn.addEventListener("click", () => {
          footerSection.classList.remove("list-view");
          footerSection.classList.add("grid-view");
          gridBtn.classList.add("active");
          listBtn.classList.remove("active");
        });

        listBtn.addEventListener("click", () => {
          footerSection.classList.remove("grid-view");
          footerSection.classList.add("list-view");
          listBtn.classList.add("active");
          gridBtn.classList.remove("active");
        });
      }

      // 화살표 클릭 시에만 about 섹션으로 이동 가능하도록 스크롤 제어
      let arrowClicked = false;
      const scrollArrow = document.getElementById("scroll-to-about");
      const heroSection = document.querySelector(".hero");
      const aboutSection = document.getElementById("about");

      if (heroSection && aboutSection) {
        // hero 섹션의 끝 위치 계산
        function getHeroBottom() {
          const rect = heroSection.getBoundingClientRect();
          return rect.bottom + window.pageYOffset;
        }

        // 스크롤 제한 함수
        function restrictScroll() {
          if (!arrowClicked) {
            const heroBottom = getHeroBottom();
            const maxScroll = heroBottom - window.innerHeight;
            const currentScroll =
              window.pageYOffset || document.documentElement.scrollTop;

            if (currentScroll > maxScroll) {
              window.scrollTo(0, maxScroll);
            }
          }
        }

        // 스크롤 이벤트 리스너
        let ticking = false;
        window.addEventListener(
          "scroll",
          () => {
            if (!ticking) {
              window.requestAnimationFrame(() => {
                restrictScroll();
                ticking = false;
              });
              ticking = true;
            }
          },
          { passive: true }
        );

        // 휠 이벤트 차단
        window.addEventListener(
          "wheel",
          (e) => {
            if (!arrowClicked) {
              const heroBottom = getHeroBottom();
              const maxScroll = heroBottom - window.innerHeight;
              const currentScroll =
                window.pageYOffset || document.documentElement.scrollTop;

              if (currentScroll >= maxScroll - 5 && e.deltaY > 0) {
                e.preventDefault();
              }
            }
          },
          { passive: false }
        );

        // 키보드 스크롤 차단
        window.addEventListener("keydown", (e) => {
          if (!arrowClicked) {
            const heroBottom = getHeroBottom();
            const maxScroll = heroBottom - window.innerHeight;
            const currentScroll =
              window.pageYOffset || document.documentElement.scrollTop;

            if (currentScroll >= maxScroll - 5) {
              if (
                e.key === "ArrowDown" ||
                e.key === "PageDown" ||
                (e.key === " " && !e.shiftKey)
              ) {
                e.preventDefault();
              }
            }
          }
        });
      }

      // 화살표 클릭 시 about 섹션으로 이동
      if (scrollArrow && aboutSection) {
        scrollArrow.addEventListener("click", () => {
          arrowClicked = true;
          aboutSection.scrollIntoView({
            behavior: "smooth",
            block: "start",
          });
        });
      }

      // hero 섹션으로 다시 돌아왔을 때 플래그 리셋
      window.addEventListener(
        "scroll",
        () => {
          if (heroSection && aboutSection && arrowClicked) {
            const heroRect = heroSection.getBoundingClientRect();
            const aboutRect = aboutSection.getBoundingClientRect();

            if (
              heroRect.top >= -50 &&
              heroRect.top < window.innerHeight &&
              aboutRect.top > window.innerHeight
            ) {
              arrowClicked = false;
            }
          }
        },
        { passive: true }
      );
    </script>
  </body>
</html>
